# PATH DEBUG
run-shell "echo \$PATH > /tmp/tmux-path.log"
# remap prefix from 'C-b' to 'C-a'
unbind C-b
set-option -g prefix C-a
bind-key C-a send-prefix

# status bar on top
set -g status-position top

# split panes with | and -
bind | split-window -h
bind - split-window -v
unbind '"'
unbind %

# ──────── 1) Pane movement (prefix + j/k/l/;) ────────
unbind h
unbind j
unbind k
unbind l

bind j select-pane -L
bind k select-pane -D
bind l select-pane -U
bind \; select-pane -R

# ──────── 2) Pane resizing (Ctrl + j/k/l/;) ────────
unbind -n C-h
unbind -n C-j
unbind -n C-k
unbind -n C-l

bind -n C-j resize-pane -L
bind -n C-k resize-pane -D
bind -n C-l resize-pane -U
bind -n C-\; resize-pane -R

# ──────── 3) Copy-mode (vi & emacs) scroll ────────
unbind -T copy-mode    h
unbind -T copy-mode    j
unbind -T copy-mode    k
unbind -T copy-mode    l
unbind -T copy-mode-vi h
unbind -T copy-mode-vi j
unbind -T copy-mode-vi k
unbind -T copy-mode-vi l

bind -T copy-mode    j send-keys -X cursor-left
bind -T copy-mode    k send-keys -X cursor-down
bind -T copy-mode    l send-keys -X cursor-up
bind -T copy-mode    \; send-keys -X cursor-right

bind -T copy-mode-vi j send-keys -X cursor-left
bind -T copy-mode-vi k send-keys -X cursor-down
bind -T copy-mode-vi l send-keys -X cursor-up
bind -T copy-mode-vi \; send-keys -X cursor-right

# ──────── 4) Menu & choose-tree navigation ────────
# # session/window picker (prefix+s):
# unbind -T choose-tree Up
# unbind -T choose-tree Down
# unbind -T choose-tree Left
# unbind -T choose-tree Right
#
# bind -T choose-tree j send-keys Left 
# bind -T choose-tree k send-keys Down
# bind -T choose-tree l send-keys Up
# bind -T choose-tree \; send-keys Right

# built-in popup menus:
# unbind -T popup Up
# unbind -T popup Down
# unbind -T popup Left
# unbind -T popup Right
#
# bind -T popup j send-keys Left
# bind -T popup k send-keys Down
# bind -T popup l send-keys Up 
# bind -T popup \; send-keys Right

# Misc keybindings
bind-key / copy-mode \; send-key ?

# Reload config
bind r source-file ~/.config/tmux/tmux.conf

# Enable mouse and set base index
set -g mouse on
set-option -g base-index 1

# Set shell and force login shell for consistent PATH in all tmux panes
set-option -g default-shell "/usr/bin/zsh"
set-option -g default-command "exec /usr/bin/zsh -l"

# Properly propagate WSL and PATH environment variables
set-option -g update-environment "WSL_INTEROP WSLENV PATH"

# Terminal color support (critical for theme + TUI apps)
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ',*:Tc'

set-environment -g PATH "/opt/homebrew/bin:/opt/homebrew/sbin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"

# --- TPM: use ~/.config/tmux/plugins instead of ~/.tmux/plugins ---
set-environment -g TMUX_PLUGIN_MANAGER_PATH "$HOME/.config/tmux/plugins"

# Declare
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'fabioluciano/tmux-tokyo-night'

### Tokyo Night Theme configuration
set -g @theme_variation 'storm'
set -g @theme_transparent_left_separator ''
set -g @theme_transparent_right_separator ''
set -g @theme_plugins 'datetime,weather,battery'
set -g @theme_plugin_datetime_icon '📅'
set -g @theme_plugin_weather_icon '🌦️'
set -g @theme_transparent_status_bar 'true'
set -g @theme_transparent_right_separator_inverse ' '
set -g @theme_transparent_left_separator_inverse ' '


# Initialize TPM (robust: pass the var inline; use bash)
run "$HOME/.config/tmux/plugins/tpm/tpm"
